---
layout: archive
permalink: /tags/
title: "All Tags"
author_profile: true
---

{% include base_path %}

{%- comment -%}
1) 모든 컬렉션에서 태그 이름을 수집 → 정렬/중복제거
{%- endcomment -%}
{% assign all_tags = "" | split: "" %}

{%- for post in site.posts -%}
  {%- if post.tags -%}
    {%- for t in post.tags -%}
      {% assign all_tags = all_tags | push: t %}
    {%- endfor -%}
  {%- endif -%}
{%- endfor -%}

{%- for c in site.collections -%}
  {%- assign label = c.label -%}
  {%- if label != "posts" -%}
    {%- for item in site[label] -%}
      {%- if item.tags -%}
        {%- for t in item.tags -%}
          {% assign all_tags = all_tags | push: t %}
        {%- endfor -%}
      {%- endif -%}
    {%- endfor -%}
  {%- endif -%}
{%- endfor -%}

{% assign all_tags = all_tags | uniq | sort %}

{%- comment -%}
2) 태그 인덱스(점프 링크)
{%- endcomment -%}
<ul>
  {%- for tag in all_tags -%}
    <li><a href="#{{ tag | slugify }}">{{ tag }}</a></li>
  {%- endfor -%}
</ul>

{%- comment -%}
3) 각 태그 섹션: posts + 모든 컬렉션에서 항목 수집 → 중복 제거 → 날짜 최신순
{%- endcomment -%}
{%- for tag in all_tags -%}
  <h2 id="{{ tag | slugify }}" class="archive__subtitle">{{ tag }}</h2>

  {%- assign results = "" | split: "" -%}

  {# 블로그 포스트 #}
  {%- for post in site.posts -%}
    {%- if post.tags and post.tags contains tag -%}
      {% assign results = results | push: post %}
    {%- endif -%}
  {%- endfor -%}

  {# 다른 모든 컬렉션 #}
  {%- for c in site.collections -%}
    {%- assign label = c.label -%}
    {%- if label != "posts" -%}
      {%- for item in site[label] -%}
        {%- if item.tags and item.tags contains tag -%}
          {% assign results = results | push: item %}
        {%- endif -%}
      {%- endfor -%}
    {%- endif -%}
  {%- endfor -%}

  {%- comment -%}
  Liquid의 uniq는 원시값에 최적화지만, 동일 객체를 한 번만 푸시하면 충분.
  정렬은 date 키 기준, 최신순(reverse).
  {%- endcomment -%}
  {% assign results = results | sort: "date" | reverse %}

  {%- for post in results -%}
    {% include archive-single.html %}
  {%- endfor -%}
{%- endfor -%}
